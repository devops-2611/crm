import{Y as v,Z as f,aa as x,j as n,G as g,M as j,r as m,a6 as C}from"./index-DwXd4TTA.js";import{M as P,D as k}from"./MUIThemeProvider-Upu1qkYL.js";import{u as A,A as F,a as T,D as z}from"./ApiConstants-B3vWYKSo.js";import{u as E}from"./useGetMerchantDetailsbyId-BL6cv0OU.js";import{C as O}from"./Container-BWWWe1xS.js";import{T as G}from"./Text-BaOLMAxN.js";import{B as h}from"./Badge-CYf1XLaT.js";import{I as K}from"./InvoiceParameters-COyNUouE.js";import"./DateTimePicker-Dn1tq8m7.js";import"./index.esm-DDE4z3sI.js";import"./Alert-BVxpVNY2.js";import"./Rating-BZxZswsB.js";import"./IconTrash-Dnpr9U1C.js";import"./Title-BfubApG4.js";function M(e){return f(e,"DD MMM YYYY").format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}const L=e=>{var r,i;let t="";const o=(r=e==null?void 0:e[0])==null?void 0:r.id,s=(i=e==null?void 0:e[0])==null?void 0:i.desc;if(o==="createdAt"&&!s?t="asc":o==="createdAt"&&s&&(t="desc"),t)return{sort:t}},N=e=>{let t="",o="";const s=e==null?void 0:e.find(i=>i.id==="fromDate"),r=e==null?void 0:e.find(i=>i.id==="toDate");if(s&&(t=s!=null&&s.value?M(s==null?void 0:s.value):"",r&&(o=r!=null&&r.value?M(r==null?void 0:r.value):"")),t||o)return{startDate:t,endDate:o}};function V(e,t,o,s){const r={merchantId:e==null?void 0:e.toString(),pageNo:s.pageIndex+1,limit:s.pageSize,...L(o),...N(t)};return F.GET(T.GET_MERCHANT_INVOICES_BY_ID(),{params:r})}const B=e=>{const{merchantId:t,columnFilters:o,EnableQuery:s,sorting:r,pagination:i}=e;return A({queryKey:["Invoices-of-Merchants",t,o,r,i],queryFn:()=>V(t,o,r,i),placeholderData:v,enabled:s,refetchOnMount:!1,refetchOnWindowFocus:!1,retry:2})};function H(){var i,l;const{merchantId:e}=x(),{data:t,error:o,isLoading:s,isFetching:r}=E(e.toString()??"");return e?n.jsxs(n.Fragment,{children:[n.jsxs(g,{children:[n.jsxs(h,{size:"lg",variant:"dot",children:["Merchant ID : ",e]}),n.jsx(h,{size:"lg",children:(l=(i=t==null?void 0:t.data)==null?void 0:i.merchant)==null?void 0:l.merchantName})]}),n.jsx(z,{mb:"md",mt:"md"})]}):n.jsx(O,{size:"lg",mt:30,className:"fallback-ui",children:n.jsx(G,{size:"xl",fw:500,children:"Merchant ID is not provided in the URL."})})}const re=()=>{var D,p;const{merchantId:e}=x(),[t,{open:o,close:s}]=j(!1),[r,i]=m.useState([]),[l,Y]=m.useState([]),[u,I]=m.useState({pageIndex:0,pageSize:10}),{data:d,isLoading:S,isError:y}=B({merchantId:e,columnFilters:r,EnableQuery:!t&&!!e,sorting:l,pagination:u}),b=m.useMemo(()=>[{accessorKey:"invoiceId",header:"Invoice ID",enableSorting:!1,enableColumnFilter:!1,maxSize:30},{accessorKey:"fromDate",header:"From Date",enableSorting:!1,maxSize:50,accessorFn:a=>new Date(a==null?void 0:a.fromDate),Cell:({cell:a})=>{const c=a.getValue();return f(c).format("DD MMM YYYY")},filterVariant:"date",muiFilterDatePickerProps:{label:"From Date",format:"DD MMM YYYY"}},{accessorKey:"toDate",header:"To Date",enableSorting:!1,maxSize:50,accessorFn:a=>new Date(a==null?void 0:a.toDate),Cell:({cell:a})=>{const c=a.getValue();return f(c).format("DD MMM YYYY")},filterVariant:"date",muiFilterDatePickerProps:{format:"DD MMM YYYY",label:"To Date"}},{accessorKey:"downloadLink",header:"Download Link",enableSorting:!1,enableColumnFilter:!1,maxSize:150,Cell:({cell:a})=>{const c=a.getValue();return c?n.jsx("a",{href:`${c}`,target:"_blank",download:`${c}`,children:"Download Invoice"}):"No Link Available"}},{accessorKey:"createdAt",header:"Created At",enableSorting:!0,enableColumnFilter:!1,maxSize:50,accessorFn:a=>new Date(a==null?void 0:a.createdAt),Cell:({cell:a})=>{const c=a.getValue();return f(c).format("DD MMM YYYY hh:mm A")},muiFilterDateTimePickerProps:{label:"Created At"},meta:{fieldType:"DateTimeRange"}}],[]);return n.jsx(P,{children:n.jsxs(m.Suspense,{fallback:n.jsx(C,{height:300,width:"100%"}),children:[n.jsx(H,{}),n.jsx(k,{data:((D=d==null?void 0:d.data)==null?void 0:D.invoices)??[],columnFilters:r,columns:b,pagination:u,sorting:l,totalRowCount:((p=d==null?void 0:d.data)==null?void 0:p.totalCount)??0,onColumnFiltersChange:i,onPaginationChange:I,onSortingChange:Y,isLoading:S,OnFilterButtonClicked:()=>o(),OnApplyFiltersClicked:()=>s(),filterDrawerIsOpen:t,isError:y,tableName:"MerchantInvoicesData",crudOperationHeader:"Invoices",columnPinning:{},uniqueIDForRows:"downloadLink",enableRowActions:!1,muiExpandButtonProps:({row:a,table:c})=>({onClick:()=>c.setExpanded({[a.id]:!a.getIsExpanded()}),sx:{transform:a.getIsExpanded()?"rotate(180deg)":"rotate(-90deg)",transition:"transform 0.2s"}}),renderDetailPanel:({row:a})=>{var c;return(c=a.original)!=null&&c.invoiceParameters?n.jsx(K,{row:a}):null}})]})})};export{re as default};

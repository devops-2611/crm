import{Q as Fe,u as N,c as $,j as n,B as G,f as V,g as ee,h as A,ab as fe,s as ge,ac as Te,r as C,b as xe,e as Ye,a as Ee,v as Ve,z as Ge,Z as E,M as be,Y as Le,L as Oe,a6 as Re,G as X,l as $e,D as le,F as ce,ad as qe,P as We,k as de}from"./index-DwXd4TTA.js";import{A as Be}from"./AppTabs-CpeB8z3Y.js";import{I as Ke,a as He,b as Ue,M as Qe,D as Ze,u as Xe,F as Je}from"./MUIThemeProvider-Upu1qkYL.js";import{u as et,A as ye,a as Ie}from"./ApiConstants-B3vWYKSo.js";import{u as tt,I as st}from"./InvoiceParameters-COyNUouE.js";import{i as De,j as at,I as nt,a as Se,u as rt,e as je,k as ot,c as it,g as ue,b as lt,F as ct,h as dt}from"./index.esm-DDE4z3sI.js";import{I as ut}from"./IconX-CuwNTDuX.js";import{s as Ce,b as ke,d as ht,e as Pe,f as we,p as pt,h as mt,i as _,C as ft,u as gt,A as xt,L as bt}from"./DateTimePicker-Dn1tq8m7.js";import{T as J}from"./Text-BaOLMAxN.js";import{A as yt}from"./AppChipComponent-LPE-MC8O.js";import{T as Y,S as he}from"./IconTrash-Dnpr9U1C.js";import{C as It}from"./Container-BWWWe1xS.js";import{T as Dt}from"./Title-BfubApG4.js";import"./Alert-BVxpVNY2.js";import"./Rating-BZxZswsB.js";var ve={root:"m_4451eb3a"};const St={},te=Fe((e,t)=>{const s=N("Center",St,e),{classNames:a,className:o,style:r,styles:d,unstyled:u,vars:b,inline:i,mod:f,...y}=s,m=$({name:"Center",props:s,classes:ve,className:o,style:r,classNames:a,styles:d,unstyled:u,vars:b});return n.jsx(G,{ref:t,mod:[{inline:i},f],...m("root"),...y})});te.classes=ve;te.displayName="@mantine/core/Center";const[jt,se]=De(),[Ct,kt]=De();var K={root:"m_7cda1cd6","root--default":"m_44da308b","root--contrast":"m_e3a01f8",label:"m_1e0e6180",remove:"m_ae386778",group:"m_1dcfd90b"};const Pt={},wt=ee((e,{gap:t},{size:s})=>({group:{"--pg-gap":t!==void 0?A(t):A(s,"pg-gap")}})),ae=V((e,t)=>{const s=N("PillGroup",Pt,e),{classNames:a,className:o,style:r,styles:d,unstyled:u,vars:b,size:i,disabled:f,...y}=s,m=se(),l=(m==null?void 0:m.size)||i||void 0,g=$({name:"PillGroup",classes:K,props:s,className:o,style:r,classNames:a,styles:d,unstyled:u,vars:b,varsResolver:wt,stylesCtx:{size:l},rootSelector:"group"});return n.jsx(Ct,{value:{size:l,disabled:f},children:n.jsx(G,{ref:t,size:l,...g("group"),...y})})});ae.classes=K;ae.displayName="@mantine/core/PillGroup";const vt={variant:"default"},Mt=ee((e,{radius:t},{size:s})=>({root:{"--pill-fz":A(s,"pill-fz"),"--pill-height":A(s,"pill-height"),"--pill-radius":t===void 0?void 0:ge(t)}})),R=V((e,t)=>{const s=N("Pill",vt,e),{classNames:a,className:o,style:r,styles:d,unstyled:u,vars:b,variant:i,children:f,withRemoveButton:y,onRemove:m,removeButtonProps:l,radius:g,size:I,disabled:D,mod:k,...c}=s,h=kt(),S=se(),j=I||(h==null?void 0:h.size)||void 0,w=(S==null?void 0:S.variant)==="filled"?"contrast":i||"default",P=$({name:"Pill",classes:K,props:s,className:o,style:r,classNames:a,styles:d,unstyled:u,vars:b,varsResolver:Mt,stylesCtx:{size:j}});return n.jsxs(G,{component:"span",ref:t,variant:w,size:j,...P("root",{variant:w}),mod:[{"with-remove":y&&!D,disabled:D||(h==null?void 0:h.disabled)},k],...c,children:[n.jsx("span",{...P("label"),children:f}),y&&n.jsx(fe,{variant:"transparent",radius:g,tabIndex:-1,"aria-hidden":!0,unstyled:u,...l,...P("remove",{className:l==null?void 0:l.className,style:l==null?void 0:l.style}),onMouseDown:p=>{var x;p.preventDefault(),p.stopPropagation(),(x=l==null?void 0:l.onMouseDown)==null||x.call(l,p)},onClick:p=>{var x;p.stopPropagation(),m==null||m(),(x=l==null?void 0:l.onClick)==null||x.call(l,p)}})]})});R.classes=K;R.displayName="@mantine/core/Pill";R.Group=ae;var Me={field:"m_45c4369d"};const _t={type:"visible"},ne=V((e,t)=>{const s=N("PillsInputField",_t,e),{classNames:a,className:o,style:r,styles:d,unstyled:u,vars:b,type:i,disabled:f,id:y,pointer:m,mod:l,...g}=s,I=se(),D=at(),k=$({name:"PillsInputField",classes:Me,props:s,className:o,style:r,classNames:a,styles:d,unstyled:u,rootSelector:"field"}),c=f||(I==null?void 0:I.disabled);return n.jsx(G,{component:"input",ref:Te(t,I==null?void 0:I.fieldRef),"data-type":i,disabled:c,mod:[{disabled:c,pointer:m},l],...k("field"),...g,id:(D==null?void 0:D.inputId)||y,"aria-invalid":I==null?void 0:I.hasError,"aria-describedby":D==null?void 0:D.describedBy,type:"text",onMouseDown:h=>!m&&h.stopPropagation()})});ne.classes=Me;ne.displayName="@mantine/core/PillsInputField";const At={},B=V((e,t)=>{const s=N("PillsInput",At,e),{children:a,onMouseDown:o,onClick:r,size:d,disabled:u,__staticSelector:b,error:i,variant:f,...y}=s,m=C.useRef();return n.jsx(jt,{value:{fieldRef:m,size:d,disabled:u,hasError:!!i,variant:f},children:n.jsx(nt,{size:d,error:i,variant:f,component:"div",ref:t,onMouseDown:l=>{var g;l.preventDefault(),o==null||o(l),(g=m.current)==null||g.focus()},onClick:l=>{var g;l.preventDefault(),r==null||r(l),(g=m.current)==null||g.focus()},...y,multiline:!0,disabled:u,__staticSelector:b||"PillsInput",withAria:!1,children:a})})});B.displayName="@mantine/core/PillsInput";B.Field=ne;const _e=C.createContext(null),Nt=_e.Provider,zt=()=>C.useContext(_e),Ft={},re=V((e,t)=>{const{value:s,defaultValue:a,onChange:o,size:r,wrapperProps:d,children:u,readOnly:b,...i}=N("SwitchGroup",Ft,e),[f,y]=xe({value:s,defaultValue:a,finalValue:[],onChange:o}),m=l=>{const g=l.currentTarget.value;!b&&y(f.includes(g)?f.filter(I=>I!==g):[...f,g])};return n.jsx(Nt,{value:{value:f,onChange:m,size:r},children:n.jsx(Se.Wrapper,{size:r,ref:t,...d,...i,labelElement:"div",__staticSelector:"SwitchGroup",children:n.jsx(Ke,{role:"group",children:u})})})});re.classes=Se.Wrapper.classes;re.displayName="@mantine/core/SwitchGroup";var Ae={root:"m_5f93f3bb",input:"m_926b4011",track:"m_9307d992",thumb:"m_93039a1d",trackLabel:"m_8277e082"};const Tt={labelPosition:"right"},Yt=ee((e,{radius:t,color:s,size:a})=>({root:{"--switch-radius":t===void 0?void 0:ge(t),"--switch-height":A(a,"switch-height"),"--switch-width":A(a,"switch-width"),"--switch-thumb-size":A(a,"switch-thumb-size"),"--switch-label-font-size":A(a,"switch-label-font-size"),"--switch-track-label-padding":A(a,"switch-track-label-padding"),"--switch-color":s?Ve(s,e):void 0}})),H=V((e,t)=>{const s=N("Switch",Tt,e),{classNames:a,className:o,style:r,styles:d,unstyled:u,vars:b,color:i,label:f,offLabel:y,onLabel:m,id:l,size:g,radius:I,wrapperProps:D,thumbIcon:k,checked:c,defaultChecked:h,onChange:S,labelPosition:j,description:w,error:P,disabled:p,variant:x,rootRef:v,mod:L,...z}=s,M=zt(),U=g||(M==null?void 0:M.size),F=$({name:"Switch",props:s,classes:Ae,className:o,style:r,classNames:a,styles:d,unstyled:u,vars:b,varsResolver:Yt}),{styleProps:Q,rest:q}=Ye(z),W=Ee(l),T=M?{checked:M.value.includes(q.value),onChange:M.onChange}:{},[O,ze]=xe({value:T.checked??c,defaultValue:h,finalValue:!1});return n.jsxs(He,{...F("root"),__staticSelector:"Switch",__stylesApiProps:s,id:W,size:U,labelPosition:j,label:f,description:w,error:P,disabled:p,bodyElement:"label",labelElement:"span",classNames:a,styles:d,unstyled:u,"data-checked":T.checked||void 0,variant:x,ref:v,mod:L,...Q,...D,children:[n.jsx("input",{...q,disabled:p,checked:O,onChange:Z=>{var ie;M?(ie=T.onChange)==null||ie.call(T,Z):S==null||S(Z),ze(Z.currentTarget.checked)},id:W,ref:t,type:"checkbox",role:"switch",...F("input")}),n.jsxs(G,{"aria-hidden":"true",mod:{error:P,"label-position":j,"without-labels":!m&&!y},...F("track"),children:[n.jsx(G,{component:"span",mod:"reduce-motion",...F("thumb"),children:k}),n.jsx("span",{...F("trackLabel"),children:O?m:y})]})]})});H.classes={...Ae,...Ue};H.displayName="@mantine/core/Switch";H.Group=re;/**
 * @license @tabler/icons-react v3.21.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ne=Ge("outline","check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]);function Et({type:e,date:t,locale:s,format:a,labelSeparator:o}){const r=d=>E(d).locale(s).format(a);return e==="default"?t===null?"":r(t):e==="multiple"?t.map(r).join(", "):e==="range"&&Array.isArray(t)?t[0]&&t[1]?`${r(t[0])} ${o} ${r(t[1])}`:t[0]?`${r(t[0])} ${o} `:"":""}function Vt({formatter:e,...t}){return(e||Et)(t)}function Gt({minDate:e,maxDate:t,timezone:s}){const a=Ce("add",new Date,s);return!e&&!t?a:e&&E(a).isBefore(e)?e:t&&E(a).isAfter(t)?t:a}function Lt({type:e,value:t,defaultValue:s,onChange:a,locale:o,format:r,closeOnChange:d,sortDates:u,labelSeparator:b,valueFormatter:i}){const f=ke(),[y,m]=be(!1),[l,g]=ht({type:e,value:t,defaultValue:s,onChange:a}),I=Vt({type:e,date:l,locale:f.getLocale(o),format:r,labelSeparator:f.getLabelSeparator(b),formatter:i}),D=h=>{d&&(e==="default"&&m.close(),e==="range"&&h[0]&&h[1]&&m.close()),g(u&&e==="multiple"?[...h].sort((S,j)=>S.getTime()-j.getTime()):h)},k=()=>D(e==="range"?[null,null]:e==="multiple"?[]:null),c=e==="range"?!!l[0]:e==="multiple"?l.length>0:l!==null;return{_value:l,setValue:D,onClear:k,shouldClear:c,formattedValue:I,dropdownOpened:y,dropdownHandlers:m}}const Ot={type:"default",valueFormat:"MMMM D, YYYY",closeOnChange:!0,sortDates:!0,dropdownType:"popover"},oe=V((e,t)=>{const s=N("DatePickerInput",Ot,e),{type:a,value:o,defaultValue:r,onChange:d,valueFormat:u,labelSeparator:b,locale:i,classNames:f,styles:y,unstyled:m,closeOnChange:l,size:g,variant:I,dropdownType:D,sortDates:k,minDate:c,maxDate:h,vars:S,defaultDate:j,valueFormatter:w,...P}=s,{resolvedClassNames:p,resolvedStyles:x}=rt({classNames:f,styles:y,props:s}),{calendarProps:v,others:L}=pt(P),{_value:z,setValue:M,formattedValue:U,dropdownHandlers:F,dropdownOpened:Q,onClear:q,shouldClear:W}=Lt({type:a,value:o,defaultValue:r,onChange:d,locale:i,format:u,labelSeparator:b,closeOnChange:l,sortDates:k,valueFormatter:w}),T=Array.isArray(z)?z[0]||j:z||j,O=ke();return n.jsx(Pe,{formattedValue:U,dropdownOpened:Q,dropdownHandlers:F,classNames:p,styles:x,unstyled:m,ref:t,onClear:q,shouldClear:W,value:z,size:g,variant:I,dropdownType:D,...L,type:a,__staticSelector:"DatePickerInput",children:n.jsx(we,{...v,size:g,variant:I,type:a,value:z,defaultDate:T||Gt({maxDate:h,minDate:c,timezone:O.getTimezone()}),onChange:M,locale:i,classNames:p,styles:x,unstyled:m,__staticSelector:"DatePickerInput",__stopPropagation:D==="popover",minDate:c,maxDate:h,date:Ce("add",v.date,O.getTimezone()),__timezoneApplied:!0})})});oe.classes={...Pe.classes,...we.classes};oe.displayName="@mantine/dates/DatePickerInput";const Rt=e=>{var a;let t={};const s=["fromDate","toDate","createdAt"];return(a=e==null?void 0:e.filter(o=>!(s!=null&&s.includes(o.id))))==null||a.forEach(o=>{var r;Array.isArray(o.value)?t[o.id]=(r=o.value)==null?void 0:r.join(","):o.id==="merchantId"?t.merchantIds=o.value:t[o.id]=o.value}),t},$t=e=>{var o,r;let t="";const s=(o=e==null?void 0:e[0])==null?void 0:o.id,a=(r=e==null?void 0:e[0])==null?void 0:r.desc;if(s==="createdAt"&&!a?t="asc":s==="createdAt"&&a&&(t="desc"),t)return{sort:t}};function pe(e){return E(e,"DD MMM YYYY").format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}const qt=e=>{let t="",s="";const a=e==null?void 0:e.find(r=>r.id==="fromDate"),o=e==null?void 0:e.find(r=>r.id==="toDate");if(a&&(t=a!=null&&a.value?pe(a==null?void 0:a.value):""),o&&(s=o!=null&&o.value?pe(o==null?void 0:o.value):""),a&&s)return{startDate:t,endDate:s};if(o)return{endDate:s};if(a)return{startDate:t}};function Wt(e,t,s){const a={pageNo:s.pageIndex+1,limit:s.pageSize,...$t(t),...Rt(e),...qt(e)};return ye.GET(Ie.GET_ALL_INVOICES_DETAILS(),{params:a})}const Bt=e=>{const{columnFilters:t,EnableQuery:s,sorting:a,pagination:o}=e,[r,d]=C.useState([]);return C.useEffect(()=>{s&&d(t)},[t,s]),et({queryKey:["All_Invoices-Grid-data",r,a,o],queryFn:()=>Wt(r,a,o),placeholderData:Le,refetchOnMount:!1,refetchOnWindowFocus:!1,retry:2})},Kt=()=>{var D,k;const[e,t]=C.useState([]),[s,a]=C.useState([]),[o,r]=C.useState({pageIndex:0,pageSize:10}),[d,{open:u,close:b}]=be(!1),{data:i,isError:f,isLoading:y}=Bt({columnFilters:e,EnableQuery:!d,sorting:s,pagination:o}),{mutateAsync:m,isPending:l,variables:g}=tt(),I=C.useMemo(()=>[{accessorKey:"merchantId",header:"Merchant ID",enableColumnFilter:!0,enableSorting:!1,maxSize:100},{accessorKey:"createdAt",header:"Created At",accessorFn:c=>new Date(c==null?void 0:c.createdAt),Cell:({cell:c})=>{const h=c.getValue();return E(h).format("DD MMM YYYY")},enableColumnFilter:!1,maxSize:150},{accessorKey:"fromDate",header:"From Date",accessorFn:c=>new Date(c==null?void 0:c.fromDate),enableSorting:!1,filterVariant:"date",muiFilterDatePickerProps:{label:"From Date",format:"DD MMM YYYY"},Cell:({cell:c})=>{const h=c.getValue();return E(h).format("DD MMM YYYY")},maxSize:150},{accessorKey:"toDate",header:"To Date",maxSize:150,enableSorting:!1,accessorFn:c=>new Date(c==null?void 0:c.toDate),Cell:({cell:c})=>{const h=c.getValue();return E(h).format("DD MMM YYYY")},filterVariant:"date",muiFilterDatePickerProps:{label:"To Date",format:"DD MMM YYYY"}},{accessorKey:"invoiceId",header:"Invoice ID",enableSorting:!1},{accessorKey:"status",header:"Status",Cell:({cell:c,row:h})=>{var S;if(c.getValue())return n.jsx(te,{children:l&&((S=g==null?void 0:g.updates)==null?void 0:S.invoiceId)===h.original.invoiceId?n.jsx(Oe,{size:"sm"}):n.jsx(H,{size:"lg",checked:c.getValue()==="PAID",onLabel:"PAID",offLabel:"UNPAID",thumbIcon:c.getValue()==="PAID"?n.jsx(Ne,{size:12,color:"var(--mantine-color-teal-6)",stroke:3}):n.jsx(ut,{size:12,color:"var(--mantine-color-red-6)",stroke:3}),styles:{trackLabel:{width:"40px",fontSize:"xl"}},onChange:j=>{m({updates:{...h==null?void 0:h.original,status:j.currentTarget.checked?"PAID":"UNPAID"}})}})})},enableColumnFilter:!0,filterVariant:"autocomplete",filterSelectOptions:[{value:"PAID",label:"PAID"},{value:"UNPAID",label:"UNPAID"}],enableSorting:!1},{accessorKey:"downloadLink",header:"Download Link",enableSorting:!1,enableColumnFilter:!1,Cell:({cell:c})=>{const h=c.getValue();return h?n.jsx("a",{href:`${h}`,target:"_blank",download:`${h}`,children:"Download Invoice"}):"No Link Available"}}],[l]);return n.jsx(Qe,{children:n.jsx(C.Suspense,{fallback:n.jsx(Re,{height:300,width:"100%"}),children:n.jsx(Ze,{data:((D=i==null?void 0:i.data)==null?void 0:D.invoices)??[],columnFilters:e,columns:I,pagination:o,sorting:s,totalRowCount:((k=i==null?void 0:i.data)==null?void 0:k.totalCount)??0,onColumnFiltersChange:t,onPaginationChange:r,onSortingChange:a,isLoading:y,OnFilterButtonClicked:()=>u(),OnApplyFiltersClicked:()=>b(),filterDrawerIsOpen:d,enableRowSelection:!1,isError:f,tableName:"AllInvoicesDisplay",crudOperationHeader:"Invoices",columnPinning:{left:["mrt-row-select"]},uniqueIDForRows:"invoiceId",enableRowActions:!1,muiExpandButtonProps:({row:c,table:h})=>({onClick:()=>h.setExpanded({[c.id]:!c.getIsExpanded()}),sx:{transform:c.getIsExpanded()?"rotate(180deg)":"rotate(-90deg)",transition:"transform 0.2s"}}),renderDetailPanel:({row:c})=>{var h;return(h=c.original)!=null&&h.invoiceParameters?n.jsx(st,{row:c}):void 0}})})})},Ht=({name:e,label:t,disabled:s})=>{const{values:a,errors:o,touched:r,setFieldValue:d}=je(),u={touched:r[e],error:o[e]},b=a[e],i=u.touched&&u.error&&typeof u.error=="string"?u.error:void 0;return n.jsx(ot,{name:e,children:({field:f})=>n.jsx("div",{children:n.jsx(oe,{...f,type:"range",label:t,value:b,onChange:y=>d(e,y),disabled:s,error:i,placeholder:"Pick dates range",valueFormat:"DD MMM YYYY",maxDate:new Date})})})};function Ut(e){var S,j,w,P;const{name:t}=e,s=mt({onDropdownClose:()=>s.resetSelectedOption(),onDropdownOpen:()=>s.updateSelectedOptionIndex("active")}),[a,o]=C.useState(""),{data:r,isLoading:d,isError:u,isFetching:b}=Xe(a,s.dropdownOpened,1,100),{values:i,setFieldValue:f,errors:y,touched:m}=je(),l={touched:m[t],error:y[t]},g=p=>{const x=i==null?void 0:i[t],v=x?x!=null&&x.includes(p)?x==null?void 0:x.filter(L=>L!==p):[...x,p]:[p];f(t,v),o("")},I=p=>f(t,i==null?void 0:i[t].filter(x=>x!==p)),D=C.useCallback(()=>{f(t,[])},[]),k=(S=i==null?void 0:i[t])==null?void 0:S.map(p=>n.jsx(R,{withRemoveButton:!0,onRemove:()=>I(p),styles:{root:{backgroundColor:"#12b886",color:"white",fontWeight:"normal"}},children:p},p)),c=(w=(j=r==null?void 0:r.data)==null?void 0:j.merchants)==null?void 0:w.map(p=>{var v;const x=p.merchantName+" ("+p.merchantId.toString()+")";return n.jsx(_.Option,{value:x,children:n.jsxs(X,{gap:"sm",children:[(v=i==null?void 0:i[t])!=null&&v.includes(x)?n.jsx(ft,{size:12}):null,n.jsx("span",{children:x})]})},x)}),h=C.useMemo(()=>{var p;return d||b?"Loading Merchants...":u?"No Merchants Found":(p=r==null?void 0:r.data)!=null&&p.totalCount&&r.data.totalCount>100?"More than 100 Merchants found, Please refine your search":null},[d,b,u,r]);return n.jsxs(_,{store:s,onOptionSubmit:g,children:[n.jsx(_.Header,{styles:{header:{borderBottom:0,paddingBottom:0}},children:n.jsx(J,{size:"sm",fw:500,children:"Select Merchants"})}),n.jsx(_.DropdownTarget,{children:n.jsx(B,{onClick:()=>s.openDropdown(),size:"md",rightSection:((P=i==null?void 0:i[t])==null?void 0:P.length)!==0&&n.jsx(fe,{size:"sm",onMouseDown:p=>p.preventDefault(),onClick:()=>{D()},"aria-label":"Clear value"}),children:n.jsxs(R.Group,{children:[k,n.jsx(_.EventsTarget,{children:n.jsx(B.Field,{onFocus:()=>s.openDropdown(),onBlur:()=>s.closeDropdown(),value:a,placeholder:"Search Merchants",onChange:p=>{s.updateSelectedOptionIndex(),o(p.currentTarget.value)},onKeyDown:p=>{var x;p.key==="Backspace"&&a.length===0&&(p.preventDefault(),I(i==null?void 0:i[t][((x=i==null?void 0:i[t])==null?void 0:x.length)-1]))}})})]})})}),n.jsx(_.Dropdown,{children:n.jsx(_.Options,{mah:300,style:{overflowY:"auto"},children:c&&c.length>0?c:n.jsx(_.Empty,{children:h})})}),l.error&&typeof l.error=="string"&&n.jsx(_.Footer,{styles:{footer:{borderTop:0}},children:n.jsx(J,{c:"red",size:"xs",children:l.error})})]})}const Qt=async e=>{if(!e.merchantIds||e.lastWeek===null)throw new Error("Missing required fields");if(!e.lastWeek&&(!e.startDate||!e.endDate))throw new Error("Start date and End date are required when 'lastWeek' is false");return ye.POST(Ie.GENERATE_INVOICE_BY_MERCHANTID_AND_DATE_RANGE(),e)},Zt=()=>{const e=$e();return gt({mutationFn:async t=>await Qt(t),onSuccess:t=>{var s,a;(a=(s=t==null?void 0:t.data)==null?void 0:s.invoices)!=null&&a.some(o=>o.status==="success")&&e.invalidateQueries({queryKey:["All_Invoices-Grid-data"]})},onError:t=>{var s,a;t instanceof xt?le.show({title:((a=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:a.message)??"Request Failed",message:"There was an error processing the invoice request.",color:"red",autoClose:5e3}):le.show({title:"Invoice Creation Failed",message:"Something went wrong.",color:"red",autoClose:5e3})}})};function Xt({data:e,headers:t,columnsMapping:s,uniqueKeyInRows:a}){const o=e==null?void 0:e.map((r,d)=>n.jsx(Y.Tr,{children:t.map(u=>n.jsx(Y.Td,{styles:{td:{textAlign:"center"}},children:u==="Status"?n.jsx(yt,{value:r[s[u]]??""}):n.jsx(J,{children:r[s[u]]??""})},u))},a&&a in r?r[a]:d));return n.jsxs(Y,{verticalSpacing:"sm",children:[n.jsx(Y.Thead,{children:n.jsx(Y.Tr,{children:t.map(r=>n.jsx(Y.Th,{styles:{th:{textAlign:"center"}},children:r},r))})}),n.jsx(Y.Tbody,{children:o})]})}const Jt=it({merchantIds:ue().of(lt().required("Merchant ID is required")).min(1,"At least one Merchant ID must be selected").required("Merchant IDs are required"),dateRange:ue().min(2,"Date Range is Required").max(2,"Date Range is Required").when("isLastWeek",{is:!0,then:e=>e.nullable("Should be Null"),otherwise:e=>e.required("required").nonNullable("Should not be Null ")})});function me(e){var t;return(t=e.map(s=>{const a=RegExp(/\((\d+)\)/).exec(s);return a?a[1]:null}).filter(s=>s!==null))==null?void 0:t.join(",")}const es=e=>e!=null&&e.isLastWeek?{merchantIds:me(e==null?void 0:e.merchantIds),lastWeek:e==null?void 0:e.isLastWeek}:{merchantIds:me(e==null?void 0:e.merchantIds),lastWeek:e==null?void 0:e.isLastWeek,startDate:e!=null&&e.dateRange[0]?e==null?void 0:e.dateRange[0]:null,endDate:e!=null&&e.dateRange[1]?e==null?void 0:e.dateRange[1]:null},ts={"Merchant ID":"merchantId",Message:"message",Status:"status"},ss=()=>{const{mutate:e,isPending:t,isSuccess:s,data:a}=Zt(),o=C.useRef(null);C.useEffect(()=>{var d,u;return s&&(a!=null&&a.data)&&ce.open({title:n.jsx(qe,{icon:n.jsx(Ne,{}),color:"teal",title:((d=a==null?void 0:a.data)==null?void 0:d.message)??"Details",mt:"md",withCloseButton:!1,styles:{root:{boxShadow:"none"}}}),children:n.jsx(Xt,{data:(u=a==null?void 0:a.data)==null?void 0:u.invoices,headers:["Merchant ID","Message","Status"],columnsMapping:ts,uniqueKeyInRows:"merchantId"}),size:"lg"}),()=>{ce.closeAll()}},[s]);const r=d=>{e(es(d))};return n.jsx(It,{size:"sm",mt:30,children:n.jsxs(We,{p:"xl",shadow:"sm",withBorder:!0,pos:"relative",children:[n.jsx(Dt,{order:5,ta:"center",mb:20,c:"grey",children:"Select Merchant Id and Date Range to generate Invoice"}),n.jsx(ct,{initialValues:{merchantIds:[],isLastWeek:!1,dateRange:[]},validationSchema:Jt,onSubmit:d=>{r(d)},innerRef:o,children:({setFieldValue:d,values:u})=>n.jsx(dt,{children:n.jsxs(he,{children:[n.jsx(he,{gap:"xs",children:n.jsx(Ut,{name:"merchantIds"})}),n.jsxs(X,{gap:"lg",grow:!0,align:"flex-start",children:[n.jsx(Ht,{name:"dateRange",label:"Select Date Range",disabled:u==null?void 0:u.isLastWeek}),n.jsx(Je,{name:"isLastWeek",label:"Last Week",OnChangeHandler:b=>{d("isLastWeek",b.target.checked),b.target.checked&&d("dateRange",[null,null])}})]}),n.jsxs(X,{grow:!0,gap:"md",mt:20,children:[n.jsx(de,{type:"submit",disabled:t,loading:t,children:"Submit"}),n.jsx(de,{type:"reset",variant:"outline",children:"Reset"})]})]})})}),n.jsx(bt,{visible:t,zIndex:1e3,overlayProps:{radius:"sm",blur:2}})]})})};function bs(){const e=[{label:"Generate Invoices",value:"Generate_Invoices",content:n.jsx(ss,{})},{label:"View Invoices",value:"View_Invoices",content:n.jsx(Kt,{})}];return n.jsx(Be,{tabs:e})}export{bs as default};

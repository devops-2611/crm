import{Y as k,Z as b,r as u,M as E,j as o,a5 as C,a6 as A}from"./index-DwXd4TTA.js";import{u as P,A as B,a as Y}from"./ApiConstants-B3vWYKSo.js";import{B as D,M as z,D as L}from"./MUIThemeProvider-Upu1qkYL.js";import{A as j}from"./Avatar-CYitsr4X.js";import"./DateTimePicker-Dn1tq8m7.js";import"./index.esm-DDE4z3sI.js";import"./Alert-BVxpVNY2.js";import"./Text-BaOLMAxN.js";import"./Rating-BZxZswsB.js";function F(a){return b(a,"DD MMM YYYY hh:mm A").format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}const W=a=>{let r={};return a==null||a.forEach(t=>{var e;Array.isArray(t.value)?r[t.id]=(e=t.value)==null?void 0:e.join(","):r[t.id]=t.value}),r},O=a=>{var i,m;let r="";const t=(i=a==null?void 0:a[0])==null?void 0:i.id,e=(m=a==null?void 0:a[0])==null?void 0:m.desc;if(t==="customerFirstName"&&!e?r="ascFirstName":t==="customerFirstName"&&e?r="descFirstName":t==="customerLastName"&&!e?r="ascLastName":t==="customerLastName"&&e?r="descLastName":t==="registrationDate"&&!e?r="ascRegistrationDate":t==="registrationDate"&&e&&(r="descRegistrationDate"),r)return{sort:r}},K=a=>{let r="",t="";const e=a==null?void 0:a.find(i=>i.id==="registrationDate");if(e&&Array.isArray(e==null?void 0:e.value)&&(r=e!=null&&e.value[0]?F(e==null?void 0:e.value[0]):"",t=e!=null&&e.value[1]?F(e==null?void 0:e.value[1]):""),r||t)return{startDate:r,endDate:t}};function V(a,r,t){const e={pageNo:t.pageIndex+1,limit:t.pageSize,...O(r),...W(a),...K(a)};return B.GET(Y.GET_CUSTOMER_DETAILS(),{params:e})}const G=a=>{const{columnFilters:r,EnableQuery:t,sorting:e,pagination:i}=a;return P({queryKey:["Customers-Grid-data",r,e,i],queryFn:()=>V(r,e,i),placeholderData:k,enabled:t,refetchOnMount:!1,refetchOnWindowFocus:!1,retry:2})},R=[{key:"customerId",name:"customerId",fieldType:"Number",label:"Customer ID",disabled:{disabledFieldForNew:!1,disableFieldForEdit:!0},hidden:{hideFieldForEDIT:!1,hideFieldForNEW:!0}},{key:"merchantId",name:"merchantId",fieldType:"Number",label:"Merchant ID"},{key:"customerFirstName",name:"customerFirstName",fieldType:"Text",label:"First Name"},{key:"customerLastName",name:"customerLastName",fieldType:"Text",label:"Last Name"},{key:"customerEmail",name:"customerEmail",fieldType:"Text",label:"Email"},{key:"customerMobile",name:"customerMobile",fieldType:"Text",label:"Mobile"},{key:"customerAddress",name:"customerAddress",fieldType:"Text",label:"Address"},{key:"customerArea",name:"customerArea",fieldType:"Text",label:"Area",meta:{}},{key:"customerPost",name:"customerPost",fieldType:"Text",label:"Postal Code"},{key:"customerDOB",name:"customerDOB",fieldType:"Date",label:"Date of Birth"},{key:"registrationDate",name:"registrationDate",fieldType:"DateTimeRange",label:"Registration Date",disabled:{disabledFieldForNew:!1,disableFieldForEdit:!0}},{key:"registrationMethod",name:"registrationMethod",fieldType:"Select",label:"Registration Method",disabled:{disabledFieldForNew:!1,disableFieldForEdit:!0},meta:{options:[{label:"Web",value:"Web"}]}},{key:"zone",name:"zone",fieldType:"Select",label:"Zone",meta:{options:[{label:"Chester",value:"Chester"},{label:"Manchester",value:"Manchester"},{label:"Birmingham",value:"Birmingham"},{label:"Wrexham",value:"Wrexham"},{label:"Ellesmere Port",value:"Ellesmere Port"},{label:"Mold",value:"Mold"},{label:"London",value:"London"},{label:"Birkenhead",value:"Birkenhead"},{label:"Wirral",value:"Wirral"}]}},{key:"profileImg",name:"profileImg",fieldType:"imageInput",label:"Profile Image"}],w=()=>{var p,y;const[a,r]=u.useState([]),[t,e]=u.useState([]),[i,m]=u.useState({pageIndex:0,pageSize:10}),[h,{open:M,close:v}]=E(!1),{data:n,isError:T,isLoading:I}=G({columnFilters:a,EnableQuery:!h,sorting:t,pagination:i}),N=u.useMemo(()=>[{accessorKey:"customerId",header:"Customer ID",enableSorting:!1,maxSize:30,Cell:({cell:l,row:s})=>{var d,c,f,g,x,S;return o.jsxs(D,{sx:{display:"flex",gap:"1rem",alignItems:"center",justifyContent:"center"},children:[o.jsx("p",{children:l.getValue()}),(d=s==null?void 0:s.original)!=null&&d.profileImg?o.jsx(C,{src:`${(c=s==null?void 0:s.original)==null?void 0:c.profileImg}`,alt:`profile ${l.getValue()}`,style:{width:40,height:40,borderRadius:"50%"}}):o.jsxs(j,{color:"cyan",radius:"xl",children:[(g=(f=s==null?void 0:s.original)==null?void 0:f.customerFirstName[0])==null?void 0:g.toUpperCase()," ",(S=(x=s==null?void 0:s.original)==null?void 0:x.customerLastName[0])==null?void 0:S.toUpperCase()]})]})}},{accessorKey:"merchantId",header:"Merchant ID",enableSorting:!1,maxSize:30,enableColumnFilter:!1},{accessorKey:"customerFirstName",header:"First Name",enableSorting:!0,maxSize:50},{accessorKey:"customerLastName",header:"Last Name",enableSorting:!0,maxSize:50},{accessorKey:"customerEmail",header:"Email",enableSorting:!1,maxSize:100},{accessorKey:"customerMobile",header:"Mobile",enableSorting:!1,maxSize:30},{accessorKey:"customerAddress",header:"Address",enableSorting:!1,enableColumnFilter:!1,maxSize:200,Cell:({cell:l,row:s})=>{var d,c;return o.jsx(D,{sx:f=>({whiteSpace:"normal",wordWrap:"break-word",maxWidth:"200px",overflowWrap:"break-word"}),children:l.getValue()+" "+((d=s.original)==null?void 0:d.customerArea)+" "+((c=s==null?void 0:s.original)==null?void 0:c.customerPost)})}},{accessorKey:"customerDOB",header:"Date of Birth",enableSorting:!1,accessorFn:l=>new Date(l==null?void 0:l.customerDOB),Cell:({cell:l})=>{const s=l.getValue();return b(s).format("DD MMM YYYY")},enableColumnFilter:!1,maxSize:50},{accessorKey:"registrationDate",header:"Registration Date",enableSorting:!0,accessorFn:l=>new Date(l.registrationDate),filterVariant:"datetime-range",Cell:({cell:l})=>{const s=l.getValue();return b(s).format("DD MMM YYYY hh:mm A")},muiFilterDateTimePickerProps:{label:"Registration Date",timeSteps:{minutes:1}},maxSize:50},{accessorKey:"zone",header:"Zone",enableSorting:!1,maxSize:30,filterVariant:"multi-select",filterSelectOptions:[{label:"Chester",value:"Chester"},{label:"Manchester",value:"Manchester"},{label:"Birmingham",value:"Birmingham"},{label:"Wrexham",value:"Wrexham"},{label:"Ellesmere Port",value:"Ellesmere Port"},{label:"Mold",value:"Mold"},{label:"London",value:"London"},{label:"Birkenhead",value:"Birkenhead"},{label:"Wirral",value:"Wirral"}]},{accessorKey:"totalOrders",header:"Total Orders",enableSorting:!1,maxSize:30,enableColumnFilter:!1}],[]);return o.jsx(z,{children:o.jsx(u.Suspense,{fallback:o.jsx(A,{height:300,width:"100%"}),children:o.jsx(L,{data:((p=n==null?void 0:n.data)==null?void 0:p.customer)??[],columnFilters:a,columns:N,pagination:i,sorting:t,totalRowCount:((y=n==null?void 0:n.data)==null?void 0:y.totalCount)??0,onColumnFiltersChange:r,onPaginationChange:m,onSortingChange:e,isLoading:I,OnFilterButtonClicked:()=>M(),OnApplyFiltersClicked:()=>v(),filterDrawerIsOpen:h,enableRowSelection:!0,isError:T,tableName:"CustomersDisplay",crudOperationHeader:"Customer",columnPinning:{left:["mrt-row-select","mrt-row-actions","customerId"]},uniqueIDForRows:"orderID",uiSchema:R})})})};export{w as default};
